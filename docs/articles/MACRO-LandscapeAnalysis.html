<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Landscape Analysis • MASH</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">MASH</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/smitdave/MASH">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Landscape Analysis</h1>
                        <h4 class="author">Sean Wu</h4>
            
            <h4 class="date">2017-06-21</h4>
          </div>

    
    
<div class="contents">
<div id="simulation" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation" class="anchor"></a>Simulation</h1>
<p>Practical limits on computation, and the problems of scaling from individuals up to continents call for sensible approaches to the quantification of parasite mobility.</p>
<div id="time-at-risk-from-individuals-to-populations" class="section level2">
<h2 class="hasAnchor">
<a href="#time-at-risk-from-individuals-to-populations" class="anchor"></a>Time at Risk : From Individuals to Populations</h2>
<p>Let <span class="math inline">\(\left\{h\right\}\)</span> enumerate the humans in some defined geographical region. We want to define an activity space algorithm <span class="math inline">\(A_i\)</span> for each <span class="math inline">\(h_i\)</span> for purposes of simulation that describes their average time at risk among all the points on the landscape where transmission occurs <span class="math inline">\(\left\{f\right\}\)</span>. The following is a proposed algorithm for doing this.</p>
<p>For practical reasons, we presume time at risk is related to time spent, so that points in <span class="math inline">\(\left\{f\right\}\)</span> are (for the most part) places where humans live. In particular, we could define this for a grid. We define a kernel that weights every point in <span class="math inline">\(\left\{f\right\}\)</span> by distance and other features: <span class="math inline">\(K = K_0 + K_1 + K_2\)</span>, where <span class="math inline">\(K_0\)</span> is home and the proportion of time at risk spent at home (or in the home patch) is <span class="math inline">\(P_0\)</span>, <span class="math inline">\(K_1\)</span> is the pair of patches and proportion of time at risk in <span class="math inline">\(\left\{f\right\}\)</span> during routine mobility sums to <span class="math inline">\(P_1\)</span>, and <span class="math inline">\(K_2\)</span> is the pair of patches and proportion of time at risk in <span class="math inline">\(\left\{f\right\}\)</span> during travel sums to <span class="math inline">\(P_2 = 1-P_0-P_1\)</span>. We can use any functional forms we want for <span class="math inline">\(K_1\)</span> or <span class="math inline">\(K_2\)</span>, choosing them to fit the data we have.</p>
<p>Whereas <span class="math inline">\(K_i\)</span> defines a set of weak propensities for the human <span class="math inline">\(h_i\)</span> to travel among points in <span class="math inline">\(\left\{f\right\}\)</span>, we assume a large fraction of human mobility is characterized of habitual movements – strong propensities to visit a few places (<span class="math inline">\(n\)</span>). To characterize these propensities, for each human we draw a set of points consistent with the average propensities determined by <span class="math inline">\(K\)</span>.</p>
<ol style="list-style-type: decimal">
<li>From <span class="math inline">\(K_1 + K_2\)</span>, compute a weight on each point <span class="math inline">\(f_k\)</span> that is not home and normalize to get <span class="math inline">\(w_k\)</span>.</li>
<li>Order the weights, and produce a CDF.</li>
<li>Draw <span class="math inline">\(n\)</span> uniform random variates <span class="math inline">\(v_j\)</span> and invert the CDF to choose locations, <span class="math inline">\(\left\{j \right\} \in \left\{f\right\}\)</span>
</li>
<li>We also use the <span class="math inline">\(v_j\)</span> to assign the proportion of time at risk that is (on average) consistent with the kernels. WLOG, let the <span class="math inline">\(v_j\)</span> represent an ordered list, and Let <span class="math inline">\(t_j = (v_{j+1} -  v_{j})/2 - (v_{j}- v_{j-1})/2 = (v_{j+1} - v_{j-1})\)</span> be the set of distances between their midpoints (or 0 or 1 for the lowest and highest j).</li>
<li>The activity space <span class="math inline">\(A_i\)</span> for the <span class="math inline">\(i^{th}\)</span> individual is the index of home and <span class="math inline">\(P_0\)</span>, list <span class="math inline">\(j\)</span> and <span class="math inline">\(t_j\)</span>, where <span class="math inline">\(\sum t_j =  P_1 + P_2\)</span>.</li>
<li>We may also want to assume that <span class="math inline">\(A_i\)</span> represents a generalized notion associated with the risk of predictable travel, but that there is some (small) residual risk associated with other travel, represented by another functional form that is easy to compute.</li>
</ol>
<p>For each <span class="math inline">\(h_i\)</span> this gives us an activity space, and we can then compute the connectivity matrix <span class="math inline">\(\psi\)</span> for any arbitrary set of patches containing <span class="math inline">\(\left\{f\right\}\)</span> by ordering the <span class="math inline">\(h\)</span> such that all the humans living in the same patches defined by <span class="math inline">\(\left\{f\right\}\)</span> or any grouping of <span class="math inline">\(\left\{f\right\}\)</span> are contiguous. Each row in a large matrix is the activity space algorithm <span class="math inline">\(A_i\)</span>. The elements of <span class="math inline">\(\psi\)</span> are the sums of the blocks of the connectivity matrix given by the rows in <span class="math inline">\(i\)</span>.</p>
<p>An advantage of defining <span class="math inline">\(\psi\)</span> in this way is that we can make an even coarser approximation that all humans in a patch have the same <span class="math inline">\(A_i\)</span>, so that computations scale with <span class="math inline">\(n \left| A \right|\)</span> rather than with $ | A | | A |$.</p>
</div>
<div id="time-at-risk-a-practical-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#time-at-risk-a-practical-approach" class="anchor"></a>Time at Risk : A Practical Approach</h2>
<p>A problem for us is that unless we wish to model the whole globe all at once, our defined geographical region is not ``closed:’’ there is some time at risk spent outside the region. We let <span class="math inline">\(\delta\)</span> denote the total force of infection from importation. This trick can actually serve us well in other ways.</p>
<p>Human population distributions have spatial structure, and they are naturally aggregated into clusters. Large cities and urban areas – highly densely populated areas – prsent a distinct problem from rural towns, as do the isolated houses away from settlements. A closely associated problem is that our data were often aggregated into some region (polygon) that defines populations in a way that are not necessarily good for simulating malaria. Our data sometimes come as the specific locations of households, or as gridded data, populations around mobile phone towers, or a country’s administrative units. We would like to develop methods allowing us to simulate malaria on whatever aggregation of populations (planar tilings) we choose that are all internally consistent. In particular, knowing how to scale up from individuals to populations can (perhaps) give us some indication of how to scale down from arbitrary tilings down to individuals and (perhaps) back up to other tilings.</p>
<p>The idea here is quite simple: that we can scale down to the smallest set of tilings (i.e. the gridded map) and scale up to the tiles defined by the union of all tiling boundaries, and thence up to the sets of populations as they come to us. Using principles described above, this works, in principle, for individual households. By running the model on an ensemble of patches, we can get a set of internal checks.</p>
<p>This works, in principle for large cities as well, though proximity, population density, and the degree of interconnectedness suggests we may wish to consider tiling the city distribution by aggregating grids up (i.e. <span class="math inline">\(2 \times 2\)</span>, <span class="math inline">\(4 \times 4\)</span>, <span class="math inline">\(8 \times 8\)</span>, <span class="math inline">\(16 \times 16\)</span>, ).</p>
</div>
<div id="scaling-the-activity-space" class="section level2">
<h2 class="hasAnchor">
<a href="#scaling-the-activity-space" class="anchor"></a>Scaling the Activity Space</h2>
<p>We start with an activity space matrix <span class="math inline">\(A\)</span>, where <span class="math inline">\(A_{i,j}\)</span> is the proportion of time at risk from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span>. Each patch has a population density, <span class="math inline">\(H_i\)</span>, a center, <span class="math inline">\(x_i,y_i\)</span> of it’s population mass, and other relevant features <span class="math inline">\(\vec \phi_i\)</span>. Each patch also has some relevant malaria properties describing malaria transmission (see below). The distance matrix <span class="math inline">\(D\)</span> for these centers has pairwise distance elements <span class="math inline">\(d_{i,j}\)</span>. To split the <span class="math inline">\(i^{th}\)</span> patch, into two patches, <span class="math inline">\(P_a\)</span> and <span class="math inline">\(P_b\)</span>, we need a new connectivity matrix, <span class="math inline">\(A'\)</span>, where the <span class="math inline">\(i^{th}\)</span> row and column are replaced by two new rows and columns. We will also need to know: the new population densities, <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span>; the features of each new patch <span class="math inline">\(\vec \phi_1\)</span> and <span class="math inline">\(\vec \phi_2\)</span>; and the center of population mass is <span class="math inline">\((x_1,y_1)\)</span> and <span class="math inline">\((x_2,y_2)\)</span>. That is, we are create an algorithm, <span class="math inline">\(F\)</span> to make a new <span class="math inline">\(A'\)</span> from <span class="math inline">\(A\)</span>: <span class="math inline">\(A' = F(i, f, A, P_i, P_a', P_b')\)</span>. We impose a rule that the quantities are conserved, so that if we reversed the process to join two patches, adding rows and columns (without knowing <span class="math inline">\(f\)</span>), we would get back to <span class="math inline">\(A = F^{-1}(A',P_1',P_2')\)</span>.</p>
<p>Note, that there is an asymmetry here in that splitting a cell requires more information than joining one: <span class="math inline">\(A'\)</span> has more information in it than <span class="math inline">\(A\)</span>. To be able to deal with this uncertainty and the asymmetry of scaling down, we want to use a general function describing time spent from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span>, <span class="math inline">\(f(d,H_i,H_j,\phi_i,\phi_j)\)</span>, so that we can deal with uncertainty in travel patterns at lower scales.</p>
<p>There are three tasks: internal connectivity (splitting <span class="math inline">\(A_{i,i}\)</span> into a <span class="math inline">\(2 \times 2\)</span> connectivity matrix to replace it); recomputing connectivity {} the <span class="math inline">\(i^{th}\)</span> patch to every other patch (splitting row of A to two rows in A’); and recomputing connectivity {} the <span class="math inline">\(i^{th}\)</span> patch from every other patch (splitting a column of A to make two columns in A’). Abusing notation a bit, the conservation condition implies that for each new element of the first new row of <span class="math inline">\(A'\)</span>:</p>
<p><span class="math display">\[A_{i,a}' = \frac{
f(d_{a,i}, H_{i}, H_a,  \phi_i, \phi_a)
}{
f(d_{a,i}, H_{i}, H_a,  \phi_i, \phi_a) +
f(d_{a,i}, H_{i}, H_b,  \phi_i, \phi_b)} A_{i,i} \]</span></p>
<p>and each element of the first new column of <span class="math inline">\(A'\)</span> obeys the rule:</p>
<p><span class="math display">\[A_{a,i}' = \frac{f(d_{a,i}, H_{a}, H_{i},  \phi_a,  \phi_i)}{f(d_{a,i}, H_{a}, H_{i},  \phi_a,  \phi_i) +f(d_{b,i}, H_{b}, H_{i},  \phi_b,  \phi_i)} A_{i,i}.\]</span></p>
<p>Internal travel must partition time spent in one patch into time spent in each patch by each population while following the same rules. Note that (droping the <span class="math inline">\(i\)</span> index) we have to create a <span class="math inline">\(2 \times 2\)</span> matrix describing time spent in each patch by members of each patch, and: <span class="math display">\[A_{i,i} H = (A_{a,a}' + A_{a,b}') H_a + (A_{b,a} + A_{b,b}) H_b.\]</span></p>
<p>Following the pattern above, we get that: <span class="math display">\[A_{a,a}' = \frac{f(0, H_a, H_b, \phi_a, \phi_b)}{f(0, H_a, H_b, \phi_a, \phi_b) + f(d_{a,b}, H_a, H_b, \phi_a, \phi_b)} A_{i,i}\]</span> and <span class="math display">\[A_{a,b}' = \frac{f(d_{a,b}, H_a, H_b, \phi_a, \phi_b)}{f(0, H_a, H_b, \phi_a, \phi_b) + f(d_{a,b}, H_a, H_b, \phi_a, \phi_b)} A_{i,i}\]</span></p>
<p>The information symmetry is more difficult than it would seem, because splitting a cell requires knowing not only the population densities, but also the locations of the new cell centers, a population-weighted location:</p>
<p><span class="math display">\[\begin{array}{rl}x_i &amp;= (H_a x_a + H_b x_b)/H_i \\
y_i &amp;= (H_a y_a + H_b y_b)/H_i\end{array}\]</span></p>
<p>Similarly, the features of the landscape must scale following similar population-weighted or area-weighted rules.</p>
</div>
<div id="scaling-transmission" class="section level2">
<h2 class="hasAnchor">
<a href="#scaling-transmission" class="anchor"></a>Scaling Transmission</h2>
<p>In scaling down a transmission model, we must assign new reproductive numbers, <span class="math inline">\(R_a\)</span> and <span class="math inline">\(R_b\)</span>, (including vectorial capacity and health seeking) to each cell in a way that conserves internal values. Ideally, we would like to have that</p>
<p><span class="math display">\[H_i x_i = H_a x_a + H_b x_b\]</span></p>
<p>Since in general, the ratio <span class="math inline">\(A_{j,a} / A_{j,b}\)</span> will be different for each <span class="math inline">\(j\)</span>, but there are only two new quantities, <span class="math inline">\(x_a\)</span> and <span class="math inline">\(x_b\)</span>, it will not be possible to satisfy this relationship generically. Instead, we will be satisfied to rescale the <span class="math inline">\(\left\{R_j\right\}\)</span> to hold prevalence constant everywhere.</p>
</div>
<div id="exercise-scaling-down-patches-to-patches" class="section level2">
<h2 class="hasAnchor">
<a href="#exercise-scaling-down-patches-to-patches" class="anchor"></a>Exercise: Scaling Down Patches to Patches</h2>
<p>Develop the algorithm for scaling from one set of large, defined patches defined with grid-based population estimates to a different set of defined patches (i.e. A3 to Wenger Populations).</p>
</div>
<div id="automated-scaling-down" class="section level2">
<h2 class="hasAnchor">
<a href="#automated-scaling-down" class="anchor"></a>Automated Scaling Down</h2>
<p>Develop the algorithm for scaling down in an automated way by defining populations based on human population density and malaria maps.</p>
</div>
<div id="malaria-connectivity" class="section level2">
<h2 class="hasAnchor">
<a href="#malaria-connectivity" class="anchor"></a>Malaria Connectivity</h2>
</div>
<div id="scaling-malaria-connectivity" class="section level2">
<h2 class="hasAnchor">
<a href="#scaling-malaria-connectivity" class="anchor"></a>Scaling Malaria Connectivity</h2>
<p>We now wish to scale down malaria connectivity using the scaled down human movement. Since time at risk scales appropriately with the new activity space matrix <span class="math inline">\(A'\)</span>, conserving malaria transmission properties must follow the constraint that the daily force of infection scales linearly as well: <span class="math inline">\(h_i = h_1' + h_2'\)</span>, and if it is possible, that the number of infected people scales approximately linearly, as well: For modeling transmission dynamics and control, we must find scaling rules for the parameters describing the underlying transmission process. To do this, we let <span class="math inline">\(R_{0,i}\)</span> and <span class="math inline">\(R_{C,i}\)</span> denote the local reproductive numbers, and <span class="math inline">\(\alpha_{i}\)</span> the proporion of cases treated, and <span class="math inline">\(\vec \eta_i\)</span> the probability distribution function of where those. We want to obtain new values for each one of the new patches | <span class="math inline">\(R_{0,\cdot}'\)</span>, <span class="math inline">\(\alpha_\cdot'\)</span>, <span class="math inline">\(R_{C,\cdot}'\)</span>, <span class="math inline">\(\vec \eta_\cdot'\)</span>, (<span class="math inline">\(\cdot = 1,2\)</span>)| that fit the data we might have when aggregated in the new patches. For this, we must specify a transmission model.</p>
</div>
<div id="ross-macdonald-model" class="section level2">
<h2 class="hasAnchor">
<a href="#ross-macdonald-model" class="anchor"></a>Ross-Macdonald Model</h2>
<p>{}</p>

<p>Given the matrix <span class="math inline">\(A\)</span> we can write out the equations for the Ross-Macdonald equations. Let <span class="math inline">\(\vec H\)</span> denote the population density in each patch, <span class="math inline">\(\vec X\)</span> the density of infected and infectious humans, <span class="math inline">\(\vec R_C\)</span> the reproductive numbers, <span class="math inline">\(c\)</span> and <span class="math inline">\(S\)</span> the parameters describing infectivity of humans and the stability index, and <span class="math inline">\(r\)</span> the recovery rate. Let <span class="math inline">\(\vec x = \vec X/\vec H\)</span>, and let <span class="math inline">\(\vec {H'} = A^T H\)</span> and <span class="math inline">\(\vec {X'} = A^T X\)</span>, and <span class="math inline">\(\vec {x'} = \vec{X'}/\vec{H'}\)</span>, then we get the following equation for changing prevalence: % <span class="math display">\[ \frac{1}{r} \frac {d \vec x}{dt}=A \left(I \frac{ \vec{H}
\vec{x'}} {\vec{H'}(1+cS\vec{x'})}\vec R_c\right)(1-\vec x) -
\vec x\]</span></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#simulation">Simulation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#time-at-risk-from-individuals-to-populations">Time at Risk : From Individuals to Populations</a></li>
      <li><a href="#time-at-risk-a-practical-approach">Time at Risk : A Practical Approach</a></li>
      <li><a href="#scaling-the-activity-space">Scaling the Activity Space</a></li>
      <li><a href="#scaling-transmission">Scaling Transmission</a></li>
      <li><a href="#exercise-scaling-down-patches-to-patches">Exercise: Scaling Down Patches to Patches</a></li>
      <li><a href="#automated-scaling-down">Automated Scaling Down</a></li>
      <li><a href="#malaria-connectivity">Malaria Connectivity</a></li>
      <li><a href="#scaling-malaria-connectivity">Scaling Malaria Connectivity</a></li>
      <li><a href="#ross-macdonald-model">Ross-Macdonald Model</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by David L. Smith, Héctor Manuel Sánchez Castellanos, Sean Wu, Robert C. Reiner, Jr., Amit Verma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
